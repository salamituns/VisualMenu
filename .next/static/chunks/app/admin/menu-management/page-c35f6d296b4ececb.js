(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4528],{68261:(e,a,t)=>{Promise.resolve().then(t.bind(t,15298))},15298:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>W});var r=t(95155),s=t(12115),i=t(63259),l=t(14085),n=t(35007),o=t(9955),d=t(15785),c=t(10371),u=t(43670),m=t(70001),f=t(63230),p=t(28701),g=t(33473),h=t(20853),x=t(196),v=t(87780),y=t(40767),b=t(98867),j=t(60872),N=t(45686),w=t(18617);let _=(0,s.createContext)({userRole:null,permissions:[],loading:!0,hasPermission:()=>!1,refreshPermissions:async()=>{}});var C=t(36972),R=t(39677),k=t(39286),A=t(29602),S=t(80937),F=t(46967),I=t(33565);let L=S.bL,E=S.l9;S.YJ,S.ZL,S.Pb,S.z6,s.forwardRef((e,a)=>{let{className:t,inset:s,children:i,...l}=e;return(0,r.jsxs)(S.ZP,{ref:a,className:(0,A.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",t),...l,children:[i,(0,r.jsx)(F.A,{className:"ml-auto h-4 w-4"})]})}).displayName=S.ZP.displayName,s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(S.G5,{ref:a,className:(0,A.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s})}).displayName=S.G5.displayName;let z=s.forwardRef((e,a)=>{let{className:t,sideOffset:s=4,...i}=e;return(0,r.jsx)(S.ZL,{children:(0,r.jsx)(S.UC,{ref:a,sideOffset:s,className:(0,A.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...i})})});z.displayName=S.UC.displayName,s.forwardRef((e,a)=>{let{className:t,inset:s,...i}=e;return(0,r.jsx)(S.q7,{ref:a,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",t),...i})}).displayName=S.q7.displayName;let D=s.forwardRef((e,a)=>{let{className:t,children:s,checked:i,...l}=e;return(0,r.jsxs)(S.H_,{ref:a,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:i,...l,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(S.VF,{children:(0,r.jsx)(b.A,{className:"h-4 w-4"})})}),s]})});D.displayName=S.H_.displayName,s.forwardRef((e,a)=>{let{className:t,children:s,...i}=e;return(0,r.jsxs)(S.hN,{ref:a,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(S.VF,{children:(0,r.jsx)(I.A,{className:"h-2 w-2 fill-current"})})}),s]})}).displayName=S.hN.displayName;let P=s.forwardRef((e,a)=>{let{className:t,inset:s,...i}=e;return(0,r.jsx)(S.JU,{ref:a,className:(0,A.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...i})});P.displayName=S.JU.displayName;let U=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(S.wv,{ref:a,className:(0,A.cn)("-mx-1 my-1 h-px bg-muted",t),...s})});U.displayName=S.wv.displayName;var T=t(91812),O=t(53561),Z=t(5565),$=t(55037),M=t(77711),G=t(76046);let B=(0,M.default)(()=>t.e(8499).then(t.bind(t,8499)),{loadableGenerated:{webpack:()=>[8499]},ssr:!1}),H={dietary:[],categories:[],availability:"all",priceRange:{min:null,max:null}};function W(){var e,a,t,S,F,I,M,W,J;let V=(0,G.useRouter)(),{user:K,loading:Q}=(0,w.A)(),{hasPermission:X,loading:q}=function(){let e=(0,s.useContext)(_);if(!e)throw Error("usePermissions must be used within a PermissionProvider");return e}(),[Y,ee]=(0,s.useState)(!1),[ea,et]=(0,s.useState)([]),[er,es]=(0,s.useState)(!0),[ei,el]=(0,s.useState)(""),[en,eo]=(0,s.useState)(null),[ed,ec]=(0,s.useState)(!1),[eu,em]=(0,s.useState)([]),[ef,ep]=(0,s.useState)(null),[eg,eh]=(0,s.useState)(""),[ex,ev]=(0,s.useState)({name:"",description:"",price:"",category:"",image_url:null,dietary_info:[],is_available:!0,special_offer:null}),[ey,eb]=(0,s.useState)("idle"),[ej,eN]=(0,s.useState)(""),[ew,e_]=(0,s.useState)(H),[eC,eR]=(0,s.useState)(!1),[ek,eA]=(0,s.useState)(new Set),[eS,eF]=(0,s.useState)(!1),[eI,eL]=(0,s.useState)(!1),[eE,ez]=(0,s.useState)(!1),[eD,eP]=(0,s.useState)({}),[eU,eT]=(0,s.useState)("grid"),eO=(0,i.U)();(0,T.FR)((0,T.MS)(T.cA,{activationConstraint:{distance:8}}),(0,T.MS)(T.IG,{activationConstraint:{delay:200,tolerance:8}})),(0,s.useEffect)(()=>{ee(!0)},[]),(0,s.useEffect)(()=>{Q||K||V.push("/login")},[Q,K,V]),(0,s.useEffect)(()=>{K&&!Q&&eZ()},[K,Q]),(0,s.useEffect)(()=>{em(Array.from(new Set(ea.map(e=>e.category_id).filter(e=>void 0!==e))))},[ea]),(0,s.useEffect)(()=>{let e=e=>{if((e.ctrlKey||e.metaKey)&&"k"===e.key){e.preventDefault();let a=document.getElementById("menu-search");a&&a.focus()}(e.ctrlKey||e.metaKey)&&"n"===e.key&&(e.preventDefault(),ec(!0),eo(null),ev({name:"",description:"",price:"",category:"",image_url:null,dietary_info:[],is_available:!0,special_offer:null}),ep(null),eh(""))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),(0,s.useEffect)(()=>()=>{eA(new Set),eP({})},[]);let eZ=async()=>{try{es(!0),el(""),console.log("Loading menu items...");let{data:e,error:a}=await eO.from("menu_items").select("*").order("order",{ascending:!0}).order("created_at",{ascending:!1});if(a)throw console.error("Error loading menu items:",a),a;if(!e){console.log("No menu items found"),et([]);return}console.log("Raw menu items from database:",e);let t=e.map(e=>{console.log("Processing item ".concat(e.id,":"),{originalPrice:e.price,originalType:typeof e.price});let a={id:e.id,name:e.name,description:e.description||"",price:parseFloat(e.price.toString()),category_id:e.category||"",image_url:e.image_url||null,image_path:null,is_available:e.is_available,dietary_info:e.dietary_info||[],created_at:new Date().toISOString(),updated_at:new Date().toISOString(),portion_sizes:[],customization_options:[]};return console.log("Processed item ".concat(e.id,":"),{processedPrice:a.price,processedType:typeof a.price}),a});console.log("Final validated menu items:",t),et(t)}catch(e){console.error("Error loading menu items:",e),el(e.message||"Failed to load menu items"),et([])}finally{es(!1)}},e$="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9IiNFNUU3RUIiLz48cGF0aCBkPSJNNDAgNDBINjBNNTAgMzBWNTAiIHN0cm9rZT0iIzlDQTNCOCIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiLz48L3N2Zz4=",eM="images",eG=async e=>{try{eb("uploading");let a=e.name.split(".").pop(),t="".concat(Date.now(),".").concat(a),{error:r}=await eO.storage.from(eM).upload(t,e);if(r)return console.error("Upload error:",r),eb("error"),$.oR.error("Failed to upload image"),null;let{data:{publicUrl:s}}=eO.storage.from(eM).getPublicUrl(t);return eb("success"),s}catch(e){return console.error("Upload error:",e),eb("error"),$.oR.error("Failed to upload image"),null}},eB=async()=>{try{let e=ex.image_url;ef&&(console.log("Uploading new image..."),e=await eG(ef),console.log("New image URL:",e));let a={name:ex.name,description:ex.description||"",price:parseFloat(ex.price),category_id:ex.category,image_url:e,dietary_info:ex.dietary_info||[],is_available:ex.is_available,special_offer:ex.special_offer};if(console.log("Saving item with data:",a),en){let{error:e}=await eO.from("menu_items").update(a).eq("id",en);if(e)throw e}else{let{error:e}=await eO.from("menu_items").insert([a]);if(e)throw e}await eZ(),eW()}catch(e){console.error("Save failed:",e),el(e.message)}};async function eH(e){try{let{error:a}=await eO.from("menu_items").delete().eq("id",e);if(a)throw a;eZ()}catch(e){console.error("Error deleting menu item:",e),el("Failed to delete menu item")}}let eW=()=>{ep(null),eh(""),ev({name:"",description:"",price:"",category:"",image_url:null,dietary_info:[],is_available:!0,special_offer:null}),eo(null)},eJ=ea.filter(e=>{var a,t;let r=""===ej||e.name.toLowerCase().includes(ej.toLowerCase())||((null===(a=e.description)||void 0===a?void 0:a.toLowerCase())||"").includes(ej.toLowerCase())||((null===(t=e.category_id)||void 0===t?void 0:t.toLowerCase())||"").includes(ej.toLowerCase()),s=0===ew.categories.length||e.category_id&&ew.categories.includes(e.category_id),i=0===ew.dietary.length||Array.isArray(e.dietary_info)&&e.dietary_info.some(e=>"string"==typeof e&&ew.dietary.includes(e)),l="all"===ew.availability||"available"===ew.availability&&e.is_available||"unavailable"===ew.availability&&!e.is_available,n=parseFloat(e.price.toString()),o=(null===ew.priceRange.min||n>=ew.priceRange.min)&&(null===ew.priceRange.max||n<=ew.priceRange.max);return r&&s&&i&&l&&o}),eV=Array.from(new Set(ea.flatMap(e=>e.dietary_info||[]).filter(e=>"string"==typeof e&&""!==e))).sort(),eK=(e,a)=>{let t=new Set(ek);a?t.add(e):t.delete(e),eA(t)},eQ=async()=>{if(ek.size)try{eL(!0),console.log("Deleting items:",Array.from(ek));let{error:e}=await eO.from("menu_items").delete().in("id",Array.from(ek));if(e)throw e;await eZ(),eA(new Set)}catch(e){console.error("Failed to delete items:",e),el("Failed to delete items: ".concat(e.message))}finally{eL(!1)}},eX=async()=>{if(ek.size&&Object.keys(eD).length)try{eF(!0),console.log("Updating items:",Array.from(ek),"with data:",eD);let{error:e}=await eO.from("menu_items").update(eD).in("id",Array.from(ek));if(e)throw e;await eZ(),eA(new Set),ez(!1),eP({})}catch(e){console.error("Failed to update items:",e),el("Failed to update items: ".concat(e.message))}finally{eF(!1)}},eq=async e=>{try{console.log("Updating item order...");let a=e.map((e,a)=>({id:e.id,name:e.name,description:e.description||"",price:parseFloat(e.price.toString()),category_id:e.category_id,order:a+1}));console.log("Updates to be applied:",a);let{data:t,error:r}=await eO.from("menu_items").upsert(a,{onConflict:"id",ignoreDuplicates:!1});if(r)throw console.error("Error updating item order:",r),r;console.log("Order update successful:",t)}catch(e){console.error("Failed to update item order:",e),el("Failed to update item order"),eZ()}},eY=e=>{e_(a=>{let t=a.dietary.filter(e=>"string"==typeof e);return{...a,dietary:t.includes(e)?t.filter(a=>a!==e):[...t,e]}})};return!Y||Q||q?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsx)(m.A,{className:"h-8 w-8 animate-spin text-primary"})}):K?ei?(0,r.jsx)("div",{className:"container mx-auto p-6",children:(0,r.jsxs)(R.Fc,{variant:"destructive",className:"mb-6",children:[(0,r.jsx)(C.A,{className:"h-4 w-4"}),(0,r.jsx)(R.XL,{children:"Error"}),(0,r.jsxs)(R.TN,{className:"flex flex-col gap-2",children:[(0,r.jsx)("p",{children:ei}),(0,r.jsx)(l.$,{variant:"outline",size:"sm",onClick:()=>{el(""),eZ()},children:"Try Again"})]})]})}):er?(0,r.jsx)("div",{className:"container mx-auto p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,r.jsx)(m.A,{className:"h-6 w-6 animate-spin"}),(0,r.jsx)("span",{children:"Loading menu items..."})]})}):(0,r.jsxs)("div",{className:"container mx-auto p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Menu Management"}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"border rounded-md p-1 flex items-center",children:[(0,r.jsx)(l.$,{variant:"ghost",size:"sm",className:(0,A.cn)("px-2 py-1","grid"===eU&&"bg-muted"),onClick:()=>eT("grid"),children:(0,r.jsx)(f.A,{className:"h-4 w-4"})}),(0,r.jsx)(l.$,{variant:"ghost",size:"sm",className:(0,A.cn)("px-2 py-1","list"===eU&&"bg-muted"),onClick:()=>eT("list"),children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]}),(0,r.jsxs)(l.$,{onClick:()=>{ec(!0),eo(null),ev({name:"",description:"",price:"",category:"",image_url:null,dietary_info:[],is_available:!0,special_offer:null}),ep(null),eh("")},children:[(0,r.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Add Item"]})]})]}),(0,r.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),(0,r.jsx)(o.p,{id:"menu-search",placeholder:"Search menu items... (Ctrl + K)",value:ej,onChange:e=>eN(e.target.value),className:"pl-10"}),ej&&(0,r.jsx)(l.$,{variant:"ghost",size:"sm",className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6",onClick:()=>eN(""),children:"Clear"})]}),(0,r.jsxs)(L,{children:[(0,r.jsx)(E,{asChild:!0,children:(0,r.jsxs)(l.$,{variant:"outline",className:"relative",children:[(0,r.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Filters",(ew.categories.length>0||ew.dietary.length>0||"all"!==ew.availability||null!==ew.priceRange.min||null!==ew.priceRange.max)&&(0,r.jsx)(k.E,{variant:"secondary",className:"ml-2 h-5 w-5 p-0 flex items-center justify-center",children:ew.categories.length+ew.dietary.length+("all"!==ew.availability?1:0)+(null!==ew.priceRange.min||null!==ew.priceRange.max?1:0)})]})}),(0,r.jsxs)(z,{className:"w-72",children:[(0,r.jsxs)(P,{className:"flex items-center justify-between",children:["Categories",eC&&(0,r.jsx)(m.A,{className:"h-4 w-4 animate-spin"})]}),(0,r.jsx)("div",{className:"max-h-48 overflow-y-auto",children:eu.map(e=>(0,r.jsx)(D,{checked:ew.categories.includes(e),onCheckedChange:a=>{e_(t=>({...t,categories:a?[...t.categories,e]:t.categories.filter(a=>a!==e)}))},children:(0,r.jsxs)("span",{className:"flex items-center justify-between w-full",children:[e,(0,r.jsx)(k.E,{variant:"secondary",className:"ml-2",children:ea.filter(a=>a.category_id===e).length})]})},e))}),(0,r.jsx)(U,{}),(0,r.jsx)(P,{children:"Dietary Options"}),(0,r.jsx)("div",{className:"max-h-48 overflow-y-auto",children:eV.map(e=>(0,r.jsx)(D,{checked:ew.dietary.includes(e),onCheckedChange:()=>{"string"==typeof e&&eY(e)},children:e},e))}),(0,r.jsx)(U,{}),(0,r.jsx)(P,{children:"Availability"}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsxs)("select",{value:ew.availability,onChange:e=>e_(a=>({...a,availability:e.target.value})),className:"w-full rounded-md border border-input bg-background px-3 py-1 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"All Items"}),(0,r.jsx)("option",{value:"available",children:"Available Only"}),(0,r.jsx)("option",{value:"unavailable",children:"Unavailable Only"})]})}),(0,r.jsx)(U,{}),(0,r.jsx)(P,{children:"Price Range"}),(0,r.jsx)("div",{className:"p-2 space-y-2",children:(0,r.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,r.jsx)(o.p,{type:"number",placeholder:"Min",value:null!==(F=ew.priceRange.min)&&void 0!==F?F:"",onChange:e=>e_(a=>({...a,priceRange:{...a.priceRange,min:e.target.value?parseFloat(e.target.value):null}})),className:"w-24"}),(0,r.jsx)("span",{children:"to"}),(0,r.jsx)(o.p,{type:"number",placeholder:"Max",value:null!==(I=ew.priceRange.max)&&void 0!==I?I:"",onChange:e=>e_(a=>({...a,priceRange:{...a.priceRange,max:e.target.value?parseFloat(e.target.value):null}})),className:"w-24"})]})}),(0,r.jsx)(U,{}),(0,r.jsx)("div",{className:"p-2",children:(0,r.jsx)(l.$,{variant:"outline",size:"sm",className:"w-full",onClick:()=>e_(H),children:"Reset All Filters"})})]})]})]}),(ew.categories.length>0||ew.dietary.length>0||"all"!==ew.availability||null!==ew.priceRange.min||null!==ew.priceRange.max)&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,r.jsx)("span",{className:"text-sm text-muted-foreground",children:"Active filters:"}),ew.categories.map(e=>(0,r.jsxs)(k.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",onClick:()=>e_(a=>({...a,categories:a.categories.filter(a=>a!==e)})),children:[e," \xd7"]},e)),ew.dietary.map(e=>(0,r.jsxs)(k.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",onClick:()=>eY(e),children:[e," \xd7"]},e)),"all"!==ew.availability&&(0,r.jsxs)(k.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",onClick:()=>e_(e=>({...e,availability:"all"})),children:["available"===ew.availability?"Available":"Unavailable"," \xd7"]}),(null!==ew.priceRange.min||null!==ew.priceRange.max)&&(0,r.jsxs)(k.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",onClick:()=>e_(e=>({...e,priceRange:{min:null,max:null}})),children:["$",null!==(M=ew.priceRange.min)&&void 0!==M?M:"0"," - $",null!==(W=ew.priceRange.max)&&void 0!==W?W:"âˆž"," \xd7"]}),(0,r.jsx)(l.$,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",onClick:()=>e_(H),children:"Clear all"})]}),0===eJ.length&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-muted mb-4",children:(0,r.jsx)(h.A,{className:"h-6 w-6 text-muted-foreground"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-1",children:"No menu items found"}),(0,r.jsx)("p",{className:"text-muted-foreground mb-4",children:"Try adjusting your search or filters to find what you're looking for."}),(0,r.jsx)(l.$,{variant:"outline",onClick:()=>{eN(""),e_(H)},children:"Reset all filters"})]})]}),ei&&(0,r.jsxs)(R.Fc,{variant:"destructive",className:"mb-6",children:[(0,r.jsx)(C.A,{className:"h-4 w-4"}),(0,r.jsx)(R.XL,{children:"Error"}),(0,r.jsx)(R.TN,{children:ei})]}),(ed||en)&&(0,r.jsxs)(n.Zp,{className:"mb-6",children:[(0,r.jsx)(n.aR,{children:(0,r.jsx)(n.ZB,{children:en?"Edit Item":"New Item"})}),(0,r.jsx)(n.Wu,{children:(0,r.jsxs)("form",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"name",children:"Name"}),(0,r.jsx)(o.p,{id:"name",value:ex.name,onChange:e=>ev({...ex,name:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"category",children:"Category"}),(0,r.jsxs)("select",{id:"category",value:ex.category,onChange:e=>ev({...ex,category:e.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[(0,r.jsx)("option",{value:"",children:"Select a category"}),eu.map(e=>(0,r.jsx)("option",{value:e,children:e},e)),(0,r.jsx)("option",{value:"new",children:"+ Add new category"})]})]}),"new"===ex.category&&(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"newCategory",children:"New Category Name"}),(0,r.jsx)(o.p,{id:"newCategory",value:ex.category,onChange:e=>ev({...ex,category:e.target.value}),placeholder:"Enter new category name"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"price",children:"Price"}),(0,r.jsx)(o.p,{id:"price",type:"number",step:"0.01",value:ex.price,onChange:e=>ev({...ex,price:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"available",children:"Availability"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"available",checked:ex.is_available,onChange:e=>ev({...ex,is_available:e.target.checked}),className:"rounded border-gray-300"}),(0,r.jsx)("span",{children:"Item is available"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"description",children:"Description"}),(0,r.jsx)(c.T,{id:"description",value:ex.description,onChange:e=>ev({...ex,description:e.target.value})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"image",children:"Image"}),(0,r.jsxs)("div",{className:"mt-1 flex items-center space-x-4",children:[(eg||ex.image_url)&&(0,r.jsxs)("div",{className:"relative w-24 h-24",children:["uploading"===ey&&(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-md z-10",children:(0,r.jsx)(m.A,{className:"h-6 w-6 animate-spin text-white"})}),(0,r.jsx)(Z.default,{src:(J=eg||ex.image_url)?J:e$,alt:"Preview",width:100,height:100,className:"rounded-md object-cover w-full h-full",onError:e=>{console.error("Image load error:",eg||ex.image_url),e.target.src=e$},unoptimized:!!(null===(e=eg||ex.image_url)||void 0===e?void 0:e.startsWith("data:")),priority:!0})]}),(0,r.jsx)(o.p,{id:"image",type:"file",accept:"image/*",onChange:e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(t){if(!t.type.startsWith("image/")){el("Please select an image file");return}if(t.size>5242880){el("Image size should be less than 5MB");return}ep(t);let e=URL.createObjectURL(t);return eh(e),ev(e=>({...e,image_url:null})),()=>URL.revokeObjectURL(e)}}})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"dietary",children:"Dietary Information"}),(0,r.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-1",children:["Vegetarian","Vegan","Gluten-Free","Dairy-Free","Halal","Kosher","Nut-Free"].map(e=>{var a;return(0,r.jsxs)("label",{className:"flex items-center space-x-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:null===(a=ex.dietary_info)||void 0===a?void 0:a.includes(e),onChange:a=>{let t=a.target.checked?[...ex.dietary_info||[],e]:(ex.dietary_info||[]).filter(a=>a!==e);ev({...ex,dietary_info:t})},className:"rounded border-gray-300"}),(0,r.jsx)("span",{children:e})]},e)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{children:"Special Offer"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-1",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"discountPrice",children:"Discount Price"}),(0,r.jsx)(o.p,{id:"discountPrice",type:"number",step:"0.01",value:(null===(a=ex.special_offer)||void 0===a?void 0:a.discount_price)||"",onChange:e=>ev({...ex,special_offer:{...ex.special_offer,discount_price:parseFloat(e.target.value)}})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"startDate",children:"Start Date"}),(0,r.jsx)(o.p,{id:"startDate",type:"date",value:(null===(t=ex.special_offer)||void 0===t?void 0:t.start_date)||"",onChange:e=>ev({...ex,special_offer:{...ex.special_offer,start_date:e.target.value}})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(d.Label,{htmlFor:"endDate",children:"End Date"}),(0,r.jsx)(o.p,{id:"endDate",type:"date",value:(null===(S=ex.special_offer)||void 0===S?void 0:S.end_date)||"",onChange:e=>ev({...ex,special_offer:{...ex.special_offer,end_date:e.target.value}})})]})]})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,r.jsx)(l.$,{variant:"outline",onClick:()=>{ec(!1),eo(null),ep(null),eh("")},children:"Cancel"}),(0,r.jsxs)(l.$,{onClick:eB,children:[(0,r.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Save"]})]})]})})]}),ek.size>0&&(0,r.jsxs)("div",{className:"sticky top-0 z-10 bg-background border-b mb-6 p-4 flex items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(u.S,{checked:ek.size===eJ.length,onCheckedChange:e=>{e?eA(new Set(eJ.map(e=>e.id))):eA(new Set)}}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[ek.size," item",1!==ek.size?"s":""," selected"]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:eE?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("select",{value:eD.category||"",onChange:e=>eP(a=>({...a,category:e.target.value||void 0})),className:"h-9 rounded-md border border-input bg-background px-3 text-sm",children:[(0,r.jsx)("option",{value:"",children:"Update Category..."}),eu.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]}),(0,r.jsxs)("select",{value:void 0===eD.is_available?"":String(eD.is_available),onChange:e=>eP(a=>({...a,is_available:""===e.target.value?void 0:"true"===e.target.value})),className:"h-9 rounded-md border border-input bg-background px-3 text-sm",children:[(0,r.jsx)("option",{value:"",children:"Update Availability..."}),(0,r.jsx)("option",{value:"true",children:"Available"}),(0,r.jsx)("option",{value:"false",children:"Unavailable"})]}),(0,r.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>{ez(!1),eP({})},children:[(0,r.jsx)(y.A,{className:"h-4 w-4 mr-1"}),"Cancel"]}),(0,r.jsxs)(l.$,{size:"sm",onClick:eX,disabled:!Object.keys(eD).length||eS,children:[eS?(0,r.jsx)(m.A,{className:"h-4 w-4 mr-1 animate-spin"}):(0,r.jsx)(b.A,{className:"h-4 w-4 mr-1"}),"Update ",ek.size," items"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l.$,{variant:"outline",size:"sm",onClick:()=>ez(!0),children:[(0,r.jsx)(j.A,{className:"h-4 w-4 mr-1"}),"Batch Edit"]}),(0,r.jsxs)(l.$,{variant:"destructive",size:"sm",onClick:eQ,disabled:eI,children:[eI?(0,r.jsx)(m.A,{className:"h-4 w-4 mr-1 animate-spin"}):(0,r.jsx)(N.A,{className:"h-4 w-4 mr-1"}),"Delete ",ek.size," items"]})]})})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsx)(B,{items:eJ,loading:er,viewMode:eU,selectedItems:ek,imageLoading:"uploading"===ey,onDragEnd:e=>{let{active:a,over:t}=e;if(t&&a.id!==t.id){let e=ea.findIndex(e=>e.id===a.id),r=ea.findIndex(e=>e.id===t.id),s=(0,O.be)(ea,e,r);et(s),eq(s)}},onSelectItem:(e,a)=>eK(e,a),onEditItem:e=>{var a,t;if(!e)return;let r=null!==(t=null===(a=e.dietary_info)||void 0===a?void 0:a.filter(e=>"string"==typeof e))&&void 0!==t?t:[],s={...e,dietary_info:r};eo(s.id),ev({name:s.name,description:s.description||"",price:s.price.toString(),category:s.category_id||"",image_url:s.image_url||null,dietary_info:r,is_available:s.is_available,special_offer:null})},onDeleteItem:eH,onImageLoad:()=>eb("success"),onImageError:()=>eb("error")})})]}):null}},39677:(e,a,t)=>{"use strict";t.d(a,{Fc:()=>o,TN:()=>c,XL:()=>d});var r=t(95155),s=t(12115),i=t(31027),l=t(29602);let n=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=s.forwardRef((e,a)=>{let{className:t,variant:s,...i}=e;return(0,r.jsx)("div",{ref:a,role:"alert",className:(0,l.cn)(n({variant:s}),t),...i})});o.displayName="Alert";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("h5",{ref:a,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",t),...s})});d.displayName="AlertTitle";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",t),...s})});c.displayName="AlertDescription"},39286:(e,a,t)=>{"use strict";t.d(a,{E:()=>n});var r=t(95155);t(12115);var s=t(31027),i=t(29602);let l=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:a,variant:t,...s}=e;return(0,r.jsx)("div",{className:(0,i.cn)(l({variant:t}),a),...s})}},14085:(e,a,t)=>{"use strict";t.d(a,{$:()=>d,r:()=>o});var r=t(95155),s=t(12115),i=t(12317),l=t(31027),n=t(29602);let o=(0,l.F)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,a)=>{let{className:t,variant:s,size:l,asChild:d=!1,...c}=e,u=d?i.DX:"button";return(0,r.jsx)(u,{className:(0,n.cn)(o({variant:s,size:l,className:t})),ref:a,...c})});d.displayName="Button"},35007:(e,a,t)=>{"use strict";t.d(a,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>n,wL:()=>u});var r=t(95155),s=t(12115),i=t(29602);let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...s})});l.displayName="Card";let n=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",t),...s})});n.displayName="CardHeader";let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("h3",{ref:a,className:(0,i.cn)("font-semibold leading-none tracking-tight",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("p",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent";let u=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",t),...s})});u.displayName="CardFooter"},43670:(e,a,t)=>{"use strict";t.d(a,{S:()=>o});var r=t(95155),s=t(12115),i=t(86352),l=t(98867),n=t(29602);let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(i.bL,{ref:a,className:(0,n.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:(0,r.jsx)(i.C1,{className:(0,n.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})})});o.displayName=i.bL.displayName},9955:(e,a,t)=>{"use strict";t.d(a,{p:()=>l});var r=t(95155),s=t(12115),i=t(29602);let l=s.forwardRef((e,a)=>{let{className:t,type:s,...l}=e;return(0,r.jsx)("input",{type:s,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...l})});l.displayName="Input"},15785:(e,a,t)=>{"use strict";t.d(a,{Label:()=>d});var r=t(95155),s=t(12115),i=t(46195),l=t(31027),n=t(29602);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)(i.b,{ref:a,className:(0,n.cn)(o(),t),...s})});d.displayName=i.b.displayName},10371:(e,a,t)=>{"use strict";t.d(a,{T:()=>l});var r=t(95155),s=t(12115),i=t(29602);let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...s})});l.displayName="Textarea"},18617:(e,a,t)=>{"use strict";t.d(a,{A:()=>c,O:()=>d});var r=t(95155),s=t(12115),i=t(63259),l=t(76046),n=t(30814);let o=(0,s.createContext)(void 0);function d(e){let{children:a}=e,[t,d]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0),m=(0,l.useRouter)(),f=(0,i.U)();(0,s.useEffect)(()=>{let{data:{subscription:e}}=f.auth.onAuthStateChange((e,a)=>{var t;d(null!==(t=null==a?void 0:a.user)&&void 0!==t?t:null),u(!1),"SIGNED_IN"===e&&m.refresh(),"SIGNED_OUT"===e&&m.refresh()});return()=>{e.unsubscribe()}},[f,m]);let p=async(e,a)=>{try{let{error:t}=await f.auth.signInWithPassword({email:e,password:a});if(t)throw t;m.push("/dashboard"),n.oR.success("Welcome back!")}catch(e){n.oR.error(e.message)}},g=async(e,a)=>{try{let{error:t}=await f.auth.signUp({email:e,password:a});if(t)throw t;n.oR.success("Check your email to confirm your account")}catch(e){n.oR.error(e.message)}},h=async()=>{try{let{error:e}=await f.auth.signOut();if(e)throw e;m.push("/"),n.oR.success("Signed out successfully")}catch(e){n.oR.error(e.message)}},x=async e=>{try{let{error:a}=await f.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(a)throw a;n.oR.success("Check your email for the reset link")}catch(e){n.oR.error(e.message)}},v=async e=>{try{if(!t)throw Error("No user logged in");let{error:a}=await f.auth.updateUser({data:{dietary:e.dietary,favorites:e.favorites,dark_mode:e.dark_mode,language:e.language}});if(a)throw a;n.oR.success("Preferences updated successfully")}catch(e){n.oR.error(e.message)}};return(0,r.jsx)(o.Provider,{value:{user:t,loading:c,preferences:(null==t?void 0:t.user_metadata)||null,signIn:p,signUp:g,signOut:h,resetPassword:x,updatePreferences:v},children:a})}function c(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},63259:(e,a,t)=>{"use strict";t.d(a,{U:()=>s});var r=t(9806);function s(){return(0,r.createClientComponentClient)()}},29602:(e,a,t)=>{"use strict";t.d(a,{cn:()=>i});var r=t(43463),s=t(69795);function i(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,s.QP)((0,r.$)(a))}}},e=>{var a=a=>e(e.s=a);e.O(0,[1181,5593,9806,9125,5934,506,7641,3768,5565,1723,8441,1517,7358],()=>a(68261)),_N_E=e.O()}]);